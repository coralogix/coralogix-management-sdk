syntax = "proto3";

package com.coralogixapis.database_catalog.v1;

import "com/coralogix/catalog/v1/common.proto";
import "com/coralogixapis/alerts/v3/alert_def.proto";
import "com/coralogixapis/apm/common/v2/alert_meta_label.proto";
import "com/coralogixapis/apm/common/v2/audit_log.proto";
import "com/coralogixapis/apm/common/v2/time_range.proto";
import "com/coralogixapis/database_catalog/v1/aggregation_type.proto";
import "com/coralogixapis/database_catalog/v1/database.proto";
import "com/coralogixapis/database_catalog/v1/error_graph_type.proto";
import "com/coralogixapis/service_catalog/v1/apm_source.proto";
import "com/coralogixapis/service_catalog/v1/repeated_widgets.proto";
import "google/protobuf/struct.proto";
import "google/protobuf/wrappers.proto";

import "com/coralogix/common/v1/audit_log.proto";
import "google/api/annotations.proto";
import "protoc-gen-openapiv2/options/annotations.proto";
import "google/api/http.proto";

message UpdateDatabaseCatalogFiltersRequest {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Update Database Catalog Filters Request"
      description: "This data structure represents a request to Update Database Catalog Filters."
      required: [
        "database_catalog_filters",
        "alert_label_filters"
      ]
    }
    external_docs: {}
  };
  repeated com.coralogix.catalog.v1.ApmFilter database_catalog_filters = 1;
  repeated com.coralogixapis.apm.common.v2.AlertMetaLabel alert_label_filters = 2;
}

message UpdateDatabaseCatalogFiltersResponse {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Update Database Catalog Filters Response"
      description: "This data structure represents a response to Update Database Catalog Filters."
      required: []
    }
    external_docs: {}
  };
  repeated com.coralogix.catalog.v1.ApmFilter database_catalog_filters = 1;
}

message GetDatabaseCatalogFiltersRequest {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Database Catalog Filters Request"
      description: "This data structure represents a request to Get Database Catalog Filters."
      required: [
        "database_name",
        "time_range"
      ]
    }
    external_docs: {}
  };
  google.protobuf.StringValue database_name = 1;
  com.coralogixapis.apm.common.v2.TimeRange time_range = 2;
}

message GetDatabaseCatalogFiltersResponse {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Database Catalog Filters Response"
      description: "This data structure represents a response to Get Database Catalog Filters."
      required: []
    }
    external_docs: {}
  };
  repeated com.coralogix.catalog.v1.ApmFilter database_catalog_filters = 1;
}

message GetDatabaseRequestLatencyGraphStreamRequest {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Database Catalog Latency Graph Stream Request"
      description: "This data structure represents a request to Get Database Catalog Latency Graph Stream."
      required: [
        "time_range"
      ]
    }
    external_docs: {}
  };
  com.coralogixapis.apm.common.v2.TimeRange time_range = 1;
  com.coralogixapis.service_catalog.v1.ApmSource apm_source = 2;
  map<string, google.protobuf.ListValue> filters = 3 [deprecated = true];
  google.protobuf.UInt64Value topk = 4;
  repeated com.coralogix.catalog.v1.ApmFilter database_catalog_filters = 5;
  repeated google.protobuf.StringValue calling_services = 6;
}

message GetDatabaseErrorsGraphStreamRequest {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Database Catalog Errors Graph Stream Request"
      description: "This data structure represents a request to Get Database Catalog Errors Graph Stream."
      required: [
        "time_range",
        "error_graph_types"
      ]
    }
    external_docs: {}
  };
  com.coralogixapis.apm.common.v2.TimeRange time_range = 1;
  com.coralogixapis.service_catalog.v1.ApmSource apm_source = 2;
  map<string, google.protobuf.ListValue> filters = 3 [deprecated = true];
  google.protobuf.UInt64Value topk = 4;
  repeated ErrorGraphType error_graph_types = 5;
  repeated com.coralogix.catalog.v1.ApmFilter database_catalog_filters = 6;
  repeated google.protobuf.StringValue calling_services = 7;
}

message GetDatabaseStatementsGraphStreamRequest {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Database Catalog Statements Graph Stream Request"
      description: "This data structure represents a request to Get Database Catalog Statements Graph Stream."
      required: [
        "time_range",
        "aggregation_types"
      ]
    }
    external_docs: {}
  };
  com.coralogixapis.apm.common.v2.TimeRange time_range = 1;
  com.coralogixapis.service_catalog.v1.ApmSource apm_source = 2;
  map<string, google.protobuf.ListValue> filters = 3 [deprecated = true];
  google.protobuf.UInt64Value topk = 4;
  repeated AggregationType aggregation_types = 5;
  repeated com.coralogix.catalog.v1.ApmFilter database_catalog_filters = 6;
  repeated google.protobuf.StringValue calling_services = 7;
}

message GetDatabaseRequestLatencyGraphStreamResponse {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Database Catalog Latency Graph Stream Response"
      description: "This data structure represents a response to Get Database Catalog Latency Graph Stream."
      required: []
    }
    external_docs: {}
  };
  com.coralogixapis.service_catalog.v1.ApmSource apm_source = 1;
  oneof widget {
    com.coralogixapis.service_catalog.v1.RepeatedLineChart avg = 2;
    com.coralogixapis.service_catalog.v1.RepeatedLineChart max = 3;
    com.coralogixapis.service_catalog.v1.RepeatedLineChart p50 = 4;
    com.coralogixapis.service_catalog.v1.RepeatedLineChart p75 = 5;
    com.coralogixapis.service_catalog.v1.RepeatedLineChart p95 = 6;
    com.coralogixapis.service_catalog.v1.RepeatedLineChart p99 = 7;
  }
  google.protobuf.UInt64Value total_amount = 8;
}

message GetDatabaseErrorsGraphStreamResponse {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Database Catalog Errors Graph Stream Response"
      description: "This data structure represents a response to Get Database Catalog Errors Graph Stream."
      required: []
    }
    external_docs: {}
  };
  com.coralogixapis.service_catalog.v1.ApmSource apm_source = 1;
  oneof widget {
    com.coralogixapis.service_catalog.v1.RepeatedLineChart error_rate = 2;
    com.coralogixapis.service_catalog.v1.RepeatedLineChart error_percentage = 3;
  }
  google.protobuf.UInt64Value total_amount = 4;
}

message GetDatabaseStatementsGraphStreamResponse {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Database Catalog Statements Graph Stream Response"
      description: "This data structure represents a response to Get Database Catalog Statements Graph Stream."
      required: [
        "time_range",
        "aggregation_types"
      ]
    }
    external_docs: {}
  };
  com.coralogixapis.service_catalog.v1.ApmSource apm_source = 1;
  oneof widget {
    com.coralogixapis.service_catalog.v1.RepeatedLineChart operations = 2;
  }
  google.protobuf.UInt64Value total_amount = 3;
}

message GetDatabasesColumnsStreamRequest {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Database Catalog Columns Stream Request"
      description: "This data structure represents a request to Get Database Catalog Columns Stream."
      required: [
        "time_range"
      ]
    }
    external_docs: {}
  };
  com.coralogixapis.apm.common.v2.TimeRange time_range = 1;
  repeated com.coralogix.catalog.v1.ApmFilter database_catalog_filters = 2;
  repeated google.protobuf.StringValue calling_services = 3;
  google.protobuf.Int64Value trend_offset = 4;
}

message GetDatabasesColumnsStreamResponse {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Database Catalog Columns Stream Response"
      description: "This data structure represents a response to Get Database Catalog Columns Stream."
      required: [
        "time_range"
      ]
    }
    external_docs: {}
  };
  repeated DatabaseData databases = 1;
  google.protobuf.StringValue query = 2;
}

message ListCallingServicesRequest {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Database Catalog Calling Services Request"
      description: "This data structure represents a request to Get Database Catalog Calling Services."
      required: [
        "time_range",
        "database_name",
        "database_name_source"
      ]
    }
    external_docs: {}
  };
  com.coralogixapis.apm.common.v2.TimeRange time_range = 1;
  google.protobuf.StringValue database_name = 2;
  google.protobuf.StringValue database_name_source = 3;
}

message ListCallingServicesResponse {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Database Catalog Calling Services Response"
      description: "This data structure represents a response to Get Database Catalog Calling Services."
      required: []
    }
    external_docs: {}
  };
  repeated google.protobuf.StringValue calling_services = 1;
}

message ListTablesRequest {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Database Catalog Tables Request"
      description: "This data structure represents a request to Get Database Catalog Calling Services."
      required: [
        "time_range",
        "database_name",
        "database_name_source"
      ]
    }
    external_docs: {}
  };
  com.coralogixapis.apm.common.v2.TimeRange time_range = 1;
  google.protobuf.StringValue database_name = 2;
  google.protobuf.StringValue database_name_source = 3;
  google.protobuf.StringValue database_system = 4;
  repeated google.protobuf.StringValue calling_services = 5;
}

message ListTablesResponse {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Database Catalog Tables Response"
      description: "This data structure represents a response to Get Database Catalog Calling Services."
      required: [
        "time_range",
        "database_name",
        "database_name_source"
      ]
    }
    external_docs: {}
  };
  repeated google.protobuf.StringValue tables = 1;
  google.protobuf.StringValue table_tag = 2;
}

message GetAffectedAlertsRequest {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Affected Alerts Request"
      description: "This data structure represents a request to Get Affected Alerts."
      required: [
        "database_catalog_filters",
        "alert_label_filters"
      ]
    }
    external_docs: {}
  };
  repeated com.coralogix.catalog.v1.ApmFilter database_catalog_filters = 1;
  repeated com.coralogixapis.apm.common.v2.AlertMetaLabel alert_label_filters = 2;
}

message GetDbHierarchyInfoFromTagsRequest {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get DB Hierarchy Info From Tags Request"
      description: "This data structure represents a request to Get DB Hierarchy Info From Tags."
      required: [
        "tags"
      ]
    }
    external_docs: {}
  };
  map<string, google.protobuf.StringValue> tags = 1;
}

message GetAffectedAlertsResponse {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get Affected Alerts Response"
      description: "This data structure represents a response to Get Affected Alerts."
      required: []
    }
    external_docs: {}
  };
  repeated com.coralogixapis.alerts.v3.AlertDef alerts = 1;
}

message GetDbHierarchyInfoFromTagsResponse {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Get DB Hierarchy Info From Tags Response"
      description: "This data structure represents a response to Get DB Hierarchy Info From Tags."
      required: []
    }
    external_docs: {}
  };
  google.protobuf.StringValue db_name = 1;
  google.protobuf.StringValue db_name_src = 2;
  google.protobuf.StringValue db_system = 3;
}

service DatabaseCatalogService {
  rpc GetDatabasesColumnsStream(GetDatabasesColumnsStreamRequest) returns (stream GetDatabasesColumnsStreamResponse) {
    option (com.coralogix.common.v1.audit_log_description).description = "get databases column stream";
  }
  rpc GetDatabaseRequestLatencyGraphStream(GetDatabaseRequestLatencyGraphStreamRequest) returns (stream GetDatabaseRequestLatencyGraphStreamResponse) {
    option (com.coralogix.common.v1.audit_log_description).description = "get database catalog requests graph";
  }
  rpc GetDatabaseErrorsGraphStream(GetDatabaseErrorsGraphStreamRequest) returns (stream GetDatabaseErrorsGraphStreamResponse) {
    option (com.coralogix.common.v1.audit_log_description).description = "get database catalog errors graph";
  }
  rpc GetDatabaseStatementsGraphStream(GetDatabaseStatementsGraphStreamRequest) returns (stream GetDatabaseStatementsGraphStreamResponse) {
    option (com.coralogix.common.v1.audit_log_description).description = "get database catalog statements graph";
  }
  rpc UpdateDatabaseCatalogFilters(UpdateDatabaseCatalogFiltersRequest) returns (UpdateDatabaseCatalogFiltersResponse) {
    option (com.coralogix.common.v1.audit_log_description).description = "Update DB Catalog Filters";
  }
  rpc GetDatabaseCatalogFilters(GetDatabaseCatalogFiltersRequest) returns (GetDatabaseCatalogFiltersResponse) {
    option (com.coralogix.common.v1.audit_log_description).description = "Get DB Catalog Filters";
  }
  rpc ListCallingServices(ListCallingServicesRequest) returns (ListCallingServicesResponse) {
    option (com.coralogix.common.v1.audit_log_description).description = "list the services calling the database";
  }
  rpc ListTables(ListTablesRequest) returns (ListTablesResponse) {
    option (com.coralogix.common.v1.audit_log_description).description = "list the tables in database";
  }
  rpc GetAffectedAlerts(GetAffectedAlertsRequest) returns (GetAffectedAlertsResponse) {
    option (com.coralogix.common.v1.audit_log_description).description = "Get Affected Alerts By Dimension Change";
  }

  rpc GetDbHierarchyInfoFromTags(GetDbHierarchyInfoFromTagsRequest) returns (GetDbHierarchyInfoFromTagsResponse) {
    option (com.coralogix.common.v1.audit_log_description).description = "Get DB Hierarchy Info From Tags";
  }
}
