syntax = "proto3";

package com.coralogixapis.alerts.v3;

import "google/protobuf/wrappers.proto";

message FlowAlertInfo  {
    repeated FlowStages stages = 1 ;
}
message FlowStages {
    oneof flow_stages {
        FlowStagesGroups flow_stages_groups = 10;
    }
     google.protobuf.Int64Value timeframe_ms = 3;
}

message FlowStagesGroups {
    repeated FlowStagesGroup groups = 1;
}
message FlowStagesGroup {
    repeated FlowStagesGroupsAlerts alerts = 1;
    NextOp next_op = 2;
}
message FlowStagesGroupsAlerts {
    google.protobuf.StringValue id = 1;
    google.protobuf.BoolValue not = 2;
}

enum NextOp {
    NEXT_OP_AND_OR_UNSPECIFIED = 0;
    NEXT_OP_OR = 1;
}