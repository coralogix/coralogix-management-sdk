syntax = "proto3";

package com.coralogix.archive.dataset.v2;

import "com/coralogix/archive/dataset/v2/dataset_rules.proto";
import "com/coralogix/archive/v1/audit_log.proto";
import "google/protobuf/timestamp.proto";

service DatasetManagementService {
  rpc GetAllDatasetRules(GetAllDatasetRulesRequest) returns (GetAllDatasetRulesResponse) {
    option (com.coralogix.archive.v1.audit_log_description).description = "Get dataset rules (by last update time, optionally)";
  }
}

message GetAllDatasetRulesRequest {
  optional google.protobuf.Timestamp updated_at = 1;
}

message TeamDatasetRules {
  uint32 team_id = 1;
  repeated DatasetRule rules = 2;
}

message GetAllDatasetRulesResponse {
  TeamDatasetRules rules = 1;
  google.protobuf.Timestamp updated_at = 2;
}
